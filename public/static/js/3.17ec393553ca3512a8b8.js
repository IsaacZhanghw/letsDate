webpackJsonp([3],{"+zSS":function(o,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});t("f+26");var n=t("vUDa"),i=t("unWt");var s=t("Zrlr"),a=t.n(s),r=function o(){a()(this,o)},l=window.ePub,c=window.QiuPen;console.log("QiuPen",c);var u={components:{reviewsBackgroud:n.a},data:function(){return{bookInfo:null,reader:null,title:"epub 阅读器",info:{page:1,totalPage:10},book:null,toc:[],meta:null,cover:null,loading:!0,open:!1,infoVisible:!1,bookmarkVisible:!1,bookmarks:[{id:"1",cfi:"epubcfi(/6/2[chapter1]!/4/14/1:0)",name:"第一个书签",posY:1},{id:"2",cfi:"",name:"第一个书签",posY:1}],searchVisible:!1,keyword:"",results:null,noteVisible:!1,editVisible:!1,note:null,notes:[],exportVisible:!1,settingVisible:!1,options:{bgColor:"#fff",fontSize:16,fontFamily:"Microsoft Yahei, Heiti SC, Heiti TC",lineHeight:2,theme:0},themes:[{id:"1",name:"白色",color:"#000",bgColor:"#fff"},{id:"2",name:"浅棕色",color:"#000",bgColor:"#f9f4e9"},{id:"3",name:"护眼",color:"#000",bgColor:"#ceeaba"},{id:"4",name:"夜间",color:"#fff",bgColor:"#000"}],highlights:[{name:"red",color:"#FFBA84"},{name:"orange",color:"#E2943B"},{name:"yellow",color:"#F7C242"},{name:"green",color:"#86C166"},{name:"blue",color:"#33A6B8"},{name:"purple",color:"#8A6BBE"}],page:{menu:[{type:"icon",icon:"list",click:this.toggle,title:"目录"},{type:"icon",icon:"info",click:this.toggleInfo,title:"书籍信息"}]}}},beforeMount:function(){},mounted:function(){this.init()},methods:{init:function(){var o=this;this.reader=r,document.getElementById("area").style.height=window.innerHeight-100+"px",this.options=this.$storage.get("options",this.options),this.bookInfo=this.sessionGetObj("bookInfo"),console.log("bookInfo",this.bookInfo),i.a.init(function(){i.a.getBook(o.bookInfo.bookId,function(e){console.log("book",e),o.loadBook(e.content)})})},initAfterLoadedBook:function(){c.init()},loadBook:function(o){var e=this;this.book=l({bookPath:o,restore:!1,spreads:!1}),this.book.getMetadata().then(function(o){e.meta=o,e.title=o.bookTitle+" – "+o.creator}),this.book.getToc().then(function(o){e.toc=o}),this.book.pageListReady.then(function(o){console.log("申请的页数"),console.log(e.book.pagination),e.info.totalPage=e.book.pagination.totalPages}),this.book.ready.all.then(function(){var o,t;console.log(e.book),o=e.book,t=function(o){e.cover=o},o.coverUrl().then(function(o){var e=new XMLHttpRequest;e.responseType="blob",e.onload=function(){var o=e.response,n=new FileReader;n.onload=function(){t&&t(n.result)},n.readAsDataURL(o)},e.open("GET",o),e.send()}),e.loading=!1,e.initAfterLoadedBook()}),this.book.renderer.forceSingle(!1),this.book.on("renderer:chapterDisplayed",function(){var o=function(o){var e=document.createElement("link");return e.rel="stylesheet",e.type="text/css",e.href=o,e}("/static/epub/common.css"),t=document.getElementsByTagName("iframe")[0];t.contentDocument.head.appendChild(o),c.create(t.contentWindow.document),c.load(e.book,e.bookInfo.bookId)}),this.book.on("book:pageChanged",function(o){console.log(o.anchorPage,o.pageRange)}),this.book.on("renderer:locationChanged",function(o){e.locationCfi=o}),this.book.renderTo("area").then(function(){e.setStyle()})},setStyle:function(){this.book&&(console.log("this.options",this.options),this.book.setStyle("font-size",this.options.fontSize+"px"),this.book.setStyle("font-family",this.options.fontFamily),this.book.setStyle("line-height",1.5),this.book.setStyle("text-indent","2rem"),this.book.setStyle("padding","5px"),this.book.renderer.forceSingle(!1),this.book.setStyle("color",this.themes[this.options.theme].color))},prev:function(){this.info.page--,this.book.prevPage()},next:function(){this.info.page++,this.book.nextPage()}}},f={render:function(){var o=this,e=o.$createElement,t=o._self._c||e;return t("div",{staticClass:"background-box"},[o._m(0),o._v(" "),t("div",{staticClass:"arrow",attrs:{id:"prev"},on:{click:o.prev}},[o._v("‹")]),o._v(" "),t("div",{staticClass:"arrow",attrs:{id:"next"},on:{click:o.next}},[o._v("›")]),o._v(" "),t("reviews-backgroud")],1)},staticRenderFns:[function(){var o=this.$createElement,e=this._self._c||o;return e("div",{attrs:{id:"wrapper"}},[e("div",{attrs:{id:"area"}}),this._v(" "),e("div",{staticClass:"page-divider"})])}]};var d=t("VU/8")(u,f,!1,function(o){t("8RRj")},"data-v-4f584046",null);e.default=d.exports},"8RRj":function(o,e){},Zrlr:function(o,e,t){"use strict";e.__esModule=!0,e.default=function(o,e){if(!(o instanceof e))throw new TypeError("Cannot call a class as a function")}},unWt:function(o,e,t){"use strict";var n=t("Zrlr"),i=t.n(n),s=t("wxAW"),a=t.n(s),r=void 0,l=new(function(){function o(){i()(this,o),this.DB_NAME="dbName",this.OBJECT="Book"}return a()(o,[{key:"init",value:function(o){var e=this,t=indexedDB.open("dbName3",1);t.onerror=function(o){console.log("连接数据库失败")},t.onsuccess=function(o){console.log("连接数据库成功")},t.onupgradeneeded=function(o){o.target.result.createObjectStore(e.OBJECT,{keyPath:"id",autoIncrement:!1}),console.log("创建对象仓库成功")},t.onsuccess=function(t){var n=t.target.result;console.log("db",n);var i=n.transaction(e.OBJECT,"readwrite");r=i.objectStore(e.OBJECT),o&&o()}}},{key:"init2",value:function(){r.put({id:"2",userName:"asd",age:24});r.get("2").onsuccess=function(){},r.delete("2").onsuccess=function(){console.log("删除数据成功")}}},{key:"getBooks",value:function(o){var e=[];r.openCursor().onsuccess=function(t){var n=t.target.result;n?(e.push(n.value),n.continue()):o&&o(e)}}},{key:"getBook",value:function(o,e){r.get(o).onsuccess=function(o){console.log("getBook"),e&&e(o.target.result)}}},{key:"addBook",value:function(o,e){r.put(o).onsuccess=function(){console.log("保存成功"),e&&e()}}},{key:"deleteBook",value:function(o,e){r.delete(o).onsuccess=function(){console.log("删除数据成功"),e&&e()}}}]),o}());e.a=l},wxAW:function(o,e,t){"use strict";e.__esModule=!0;var n,i=t("C4MV"),s=(n=i)&&n.__esModule?n:{default:n};e.default=function(){function o(o,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),(0,s.default)(o,n.key,n)}}return function(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}}()}});